/*!
 * Tenuki v0.3.1 (https://github.com/aprescott/tenuki)
 * Copyright Â© 2016-2019 Adam Prescott.
 * Licensed under the MIT license.
 */
!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.tenuki=t()}}(function(){var t,e,r;return function o(a,s,u){function l(r,t){if(!s[r]){if(!a[r]){var e=typeof require=="function"&&require;if(!t&&e)return e(r,!0);if(f)return f(r,!0);var n=new Error("Cannot find module '"+r+"'");throw n.code="MODULE_NOT_FOUND",n}var i=s[r]={exports:{}};a[r][0].call(i.exports,function(t){var e=a[r][1][t];return l(e?e:t)},i,i.exports,o,a,s,u)}return s[r].exports}var f=typeof require=="function"&&require;for(var t=0;t<u.length;t++)l(u[t]);return l}({1:[function(t,e,r){"use strict";r.Game=t("./lib/game")["default"];r.Client=t("./lib/client")["default"];r.utils=t("./lib/utils")["default"]},{"./lib/client":3,"./lib/game":6,"./lib/utils":14}],2:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r["default"]=void 0;var u=n(t("./utils"));var l=n(t("./intersection"));var v=n(t("./zobrist"));function n(t){return t&&t.__esModule?t:{default:t}}function f(t,e){return c(t)||s(t,e)||o(t,e)||i()}function i(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(t,e){if(!t)return;if(typeof t==="string")return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor)r=t.constructor.name;if(r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(t,e)}function a(t,e){if(e==null||e>t.length)e=t.length;for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function s(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);u=!0);}catch(t){l=!0,i=t}finally{try{if(!u&&null!=r["return"]&&(a=r["return"](),Object(a)!==a))return}finally{if(l)throw i}}return s}}function c(t){if(Array.isArray(t))return t}var p=function t(e){var r=e.moveNumber,n=e.playedPoint,i=e.color,o=e.pass,a=e.blackPassStones,s=e.whitePassStones,u=e.intersections,l=e.blackStonesCaptured,f=e.whiteStonesCaptured,c=e.capturedPositions,d=e.koPoint,h=e.boardSize;this.moveNumber=r;this.playedPoint=n;this.color=i;this.pass=o;this.blackPassStones=a;this.whitePassStones=s;this.intersections=u;this.blackStonesCaptured=l;this.whiteStonesCaptured=f;this.capturedPositions=c;this.koPoint=d;this.boardSize=h;this._positionHash=v["default"].hash(h,u);Object.freeze(this)};p.prototype={copyWithAttributes:function t(e){var r=function t(e){var r=e.moveNumber,n=e.playedPoint,i=e.color,o=e.pass,a=e.blackPassStones,s=e.whitePassStones,u=e.intersections,l=e.blackStonesCaptured,f=e.whiteStonesCaptured,c=e.capturedPositions,d=e.koPoint,h=e.boardSize;return{moveNumber:r,playedPoint:n,color:i,pass:o,blackPassStones:a,whitePassStones:s,intersections:u,blackStonesCaptured:l,whiteStonesCaptured:f,capturedPositions:c,koPoint:d,boardSize:h}};var n=r(this);var i=r(Object.assign(n,e));return new p(i)},_capturesFrom:function t(e,r,n){var i=this;var o=this.neighborsFor(e,r).filter(function(t){console.log("neighbor.isEmpty() =",t.isEmpty()," | neighbor.value =",t.value," | y, x =",t.y,", ",t.x);return!t.isEmpty()&&t.value!==n&&i.libertiesAt(t.y,t.x)===1});var a=u["default"].flatMap(o,function(t){return i.groupAt(t.y,t.x)});var s=a.filter(function(t){return t.value!=="blue"});if(s){console.log("_capturesFrom >> capturedStones = ",s)}return u["default"].unique(s)},_updateIntersection:function t(e,r,n){return r.map(function(t){if(t.y===e.y&&t.x===e.x){return new l["default"](t.y,t.x,n)}else{return t}})},_removeIntersection:function t(e,r){return this._updateIntersection(e,r,"empty")},_withoutIntersectionsMatching:function t(e){var r=this.intersections.map(function(t){if(e(t)){return new l["default"](t.y,t.x,"empty")}else{return t}});return this._withNewPoints(r)},_withNewPoints:function t(e){return this.copyWithAttributes({intersections:e})},nextColor:function t(){if(this.color==="black"){return"white"}else{return"black"}},yCoordinateFor:function t(e){return this.boardSize-e},xCoordinateFor:function t(e){var r=["A","B","C","D","E","F","G","H","J","K","L","M","N","O","P","Q","R","S","T"];return r[e]},playPass:function t(e){var r={moveNumber:this.moveNumber+1,playedPoint:null,color:e,pass:true,blackPassStones:this.blackPassStones,whitePassStones:this.whitePassStones,intersections:this.intersections,blackStonesCaptured:this.blackStonesCaptured,whiteStonesCaptured:this.whiteStonesCaptured,capturedPositions:[],koPoint:null,boardSize:this.boardSize};r[e+"PassStones"]+=1;var n=new p(r);return n},_simpleKoPoint:function t(){var e=null;if(this.playedPoint){var r=this.playedPoint,n=r.y,i=r.x;if(this.capturedPositions.length===1&&this.groupAt(n,i).length===1&&this.inAtari(n,i)){e=this.capturedPositions[0]}}return e},playAt:function t(e,r,n){var i=this;var o=this._capturesFrom(e,r,n);console.log("playAt >> capturedPositions =",o);if(o){o=o.filter(function(t){return t.value!=="blue"});console.log("capturedPositions =",o)}var a=this.intersectionAt(e,r);var s=this.intersections;o.forEach(function(t){s=i._removeIntersection(t,s)});s=this._updateIntersection(a,s,n);var u=this.blackStonesCaptured+(n==="black"?0:o.length);var l=this.whiteStonesCaptured+(n==="white"?0:o.length);var f=this.boardSize;var c={moveNumber:this.moveNumber+1,playedPoint:Object.freeze({y:e,x:r}),color:n,pass:false,blackPassStones:this.blackPassStones,whitePassStones:this.whitePassStones,intersections:s,blackStonesCaptured:u,whiteStonesCaptured:l,capturedPositions:o,boardSize:f};var d=new p(c);var h=d._simpleKoPoint();if(h){c["koPoint"]={y:h.y,x:h.x}}else{c["koPoint"]=null}return new p(c)},intersectionAt:function t(e,r){if(e>=this.boardSize||r>=this.boardSize){throw new Error("Intersection at (".concat(e,", ").concat(r,") would be outside the board"))}if(e<0||r<0){throw new Error("Intersection position cannot be negative, but was given (".concat(e,", ").concat(r,")"))}return this.intersections[e*this.boardSize+r]},groupAt:function t(e,r){var n=this.intersectionAt(e,r);var i=this.partitionTraverse(n,function(t){return t.sameColorAs(n)}),o=f(i,2),a=o[0],s=o[1];return a},libertiesAt:function t(e,r){var n=this;var i=this.intersectionAt(e,r);var o=u["default"].flatMap(this.groupAt(i.y,i.x),function(t){return n.neighborsFor(t.y,t.x).filter(function(t){return t.isEmpty()})});return u["default"].unique(o).length},inAtari:function t(e,r){return this.libertiesAt(e,r)===1},neighborsFor:function t(e,r){var n=[];if(r>0){n.push(this.intersectionAt(e,r-1))}if(r<this.boardSize-1){n.push(this.intersectionAt(e,r+1))}if(e>0){n.push(this.intersectionAt(e-1,r))}if(e<this.boardSize-1){n.push(this.intersectionAt(e+1,r))}return n},positionSameAs:function t(e){return this._positionHash===e._positionHash&&this.intersections.every(function(t){return t.sameColorAs(e.intersectionAt(t.y,t.x))})},partitionTraverse:function t(e,r){var n=[];var i=[];var o=[];o.push(e);while(o.length>0){var a=o.pop();if(n.indexOf(a)>-1){}else{n.push(a);this.neighborsFor(a.y,a.x).forEach(function(t){if(n.indexOf(t)>-1){}else{if(r(t)){o.push(t)}else{i.push(t)}}})}}return[n,u["default"].unique(i)]}};p._initialFor=function(r,t,e){this._cache=this._cache||{};this._cache[r]=this._cache[r]||{};if(this._cache[r][t]){return this._cache[r][t]}var n=Array.apply(null,Array(r*r));n=n.map(function(t,e){return new l["default"](Math.floor(e/r),e%r)});var i=Number(e.yPos)*19+Number(e.xPos);n[i]=new l["default"](Number(e.yPos),Number(e.xPos),"blue");var o=r>11?3:2;var a={topRight:{y:o,x:r-o-1},bottomLeft:{y:r-o-1,x:o},bottomRight:{y:r-o-1,x:r-o-1},topLeft:{y:o,x:o},middle:{y:(r+1)/2-1,x:(r+1)/2-1},middleLeft:{y:(r+1)/2-1,x:o},middleRight:{y:(r+1)/2-1,x:r-o-1},middleTop:{y:o,x:(r+1)/2-1},middleBottom:{y:r-o-1,x:(r+1)/2-1}};var s={0:[],1:[],2:[a.topRight,a.bottomLeft],3:[a.topRight,a.bottomLeft,a.bottomRight],4:[a.topRight,a.bottomLeft,a.bottomRight,a.topLeft],5:[a.topRight,a.bottomLeft,a.bottomRight,a.topLeft,a.middle],6:[a.topRight,a.bottomLeft,a.bottomRight,a.topLeft,a.middleLeft,a.middleRight],7:[a.topRight,a.bottomLeft,a.bottomRight,a.topLeft,a.middleLeft,a.middleRight,a.middle],8:[a.topRight,a.bottomLeft,a.bottomRight,a.topLeft,a.middleLeft,a.middleRight,a.middleTop,a.middleBottom],9:[a.topRight,a.bottomLeft,a.bottomRight,a.topLeft,a.middleLeft,a.middleRight,a.middleTop,a.middleBottom,a.middle]};s[t].forEach(function(t){n[t.y*r+t.x]=new l["default"](t.y,t.x,"black")});var u=new p({color:t>1?"black":"white",moveNumber:0,intersections:Object.freeze(n),blackStonesCaptured:0,whiteStonesCaptured:0,whitePassStones:0,blackPassStones:0,boardSize:r});this._cache[r][t]=u;return u};var d=r["default"]=p},{"./intersection":7,"./utils":14,"./zobrist":15}],3:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r["default"]=void 0;var a=n(t("./game"));function n(t){return t&&t.__esModule?t:{default:t}}function i(t){"@babel/helpers - typeof";return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach(function(t){u(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function u(t,e,r){e=l(e);if(e in t){Object.defineProperty(t,e,{value:r,enumerable:true,configurable:true,writable:true})}else{t[e]=r}return t}function l(t){var e=f(t,"string");return"symbol"==i(e)?e:String(e)}function f(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var c=function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this._boardElement=e["element"];this._setup(e)};c.prototype={_setup:function t(e){var i=this;var r=e.player,n=e.gameOptions,o=e.hooks;this._player=r;this._hooks=o;if(this._player!=="black"&&this._player!=="white"){throw new Error("Player must be either black or white, but was given: "+this._player)}n["_hooks"]={handleClick:function t(e,r){if(i._busy){return}i._busy=true;if(i.isOver()){var n=i._game.currentState().groupAt(e,r).map(function(t){return{y:t.y,x:t.x,color:t.color}});i._hooks.submitMarkDeadAt(e,r,n,function(t){if(t){i._game.toggleDeadAt(e,r)}i._busy=false})}else{if(i._player!==i.currentPlayer()||i._game.isIllegalAt(e,r)){i._busy=false;return}i._hooks.submitPlay(e,r,function(t){if(t){i._game.playAt(e,r)}i._busy=false})}},hoverValue:function t(e,r){if(!i._busy&&i._player===i.currentPlayer()&&!i.isOver()&&!i._game.isIllegalAt(e,r)){return i._player}},gameIsOver:function t(){return i.isOver()}};if(this._boardElement){this._game=new a["default"](Object.assign({element:this._boardElement},n))}else{this._game=new a["default"](s({},n))}},isOver:function t(){return this._game.isOver()},currentPlayer:function t(){return this._game.currentPlayer()},receivePlay:function t(e,r){if(this._player===this.currentPlayer()){return}this._game.playAt(e,r)},moveNumber:function t(){return this._game.moveNumber()},receivePass:function t(){if(this._player===this.currentPlayer()){return}this._game.pass()},receiveMarkDeadAt:function t(e,r){this._game.toggleDeadAt(e,r)},deadStones:function t(){return this._game.deadStones()},setDeadStones:function t(e){this._game._deadPoints=e.map(function(t){return{y:t.y,x:t.x}});this._game.render()},pass:function t(){var e=this;if(this._busy||this._player!==this.currentPlayer()||this.isOver()){return}this._busy=true;this._hooks.submitPass(function(t){if(t){e._game.pass()}e._busy=false})}};var d=r["default"]=c},{"./game":6}],4:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r["default"]=void 0;var l=n(t("./utils"));var f=n(t("./renderer"));function n(t){return t&&t.__esModule?t:{default:t}}var i=function t(e,r){var n=r.hooks,i=r.options;f["default"].call(this,e,{hooks:n,options:i});if(this.smallerStones){l["default"].addClass(e,"tenuki-smaller-stones")}l["default"].addClass(e,"tenuki-dom-renderer")};i.prototype=Object.create(f["default"].prototype);i.prototype.constructor=i;i.prototype._setup=function(t){f["default"].prototype._setup.call(this,t);this.BOARD_LENGTH+=1;this.computeSizing()};i.prototype.generateBoard=function(t){var r=this;var n=l["default"].createElement("div");l["default"].appendElement(n,l["default"].createElement("div",{class:"lines horizontal"}));l["default"].appendElement(n,l["default"].createElement("div",{class:"lines vertical"}));l["default"].appendElement(n,l["default"].createElement("div",{class:"hoshi-points"}));l["default"].appendElement(n,l["default"].createElement("div",{class:"intersections"}));f["default"].hoshiPositionsFor(t.boardSize).forEach(function(t){var e=l["default"].createElement("div",{class:"hoshi"});e.style.left=t.left*(r.INTERSECTION_GAP_SIZE+1)+"px";e.style.top=t.top*(r.INTERSECTION_GAP_SIZE+1)+"px";l["default"].appendElement(n.querySelector(".hoshi-points"),e)});for(var e=0;e<t.boardSize;e++){var i=l["default"].createElement("div",{class:"line horizontal"});i.setAttribute("data-left-gutter",t.yCoordinateFor(e));l["default"].appendElement(n.querySelector(".lines.horizontal"),i);var o=l["default"].createElement("div",{class:"line vertical"});o.setAttribute("data-top-gutter",t.xCoordinateFor(e));l["default"].appendElement(n.querySelector(".lines.vertical"),o);for(var a=0;a<t.boardSize;a++){var s=l["default"].createElement("div",{class:"intersection empty"});var u=l["default"].createElement("div",{class:"stone"});l["default"].appendElement(s,u);s.setAttribute("data-position-x",a);s.setAttribute("data-position-y",e);s.style.left=a*(this.INTERSECTION_GAP_SIZE+1)+"px";s.style.top=e*(this.INTERSECTION_GAP_SIZE+1)+"px";l["default"].appendElement(n.querySelector(".intersections"),s);this.grid[e]=this.grid[e]||[];this.grid[e][a]=s;this.addIntersectionEventListeners(s,e,a)}}l["default"].addEventListener(n.querySelector(".lines.horizontal"),"mousedown",function(t){t.preventDefault()});l["default"].addEventListener(n.querySelector(".lines.vertical"),"mousedown",function(t){t.preventDefault()});n.querySelector(".lines.horizontal").style.width=this.INTERSECTION_GAP_SIZE*(t.boardSize-1)+t.boardSize+"px";n.querySelector(".lines.horizontal").style.height=this.INTERSECTION_GAP_SIZE*(t.boardSize-1)+t.boardSize+"px";n.querySelector(".lines.vertical").style.width=this.INTERSECTION_GAP_SIZE*(t.boardSize-1)+t.boardSize+"px";n.querySelector(".lines.vertical").style.height=this.INTERSECTION_GAP_SIZE*(t.boardSize-1)+t.boardSize+"px";return n};i.prototype.setIntersectionClasses=function(t,e,r){if(t.className!==r.join(" ")){t.className=r.join(" ")}};var o=r["default"]=i},{"./renderer":10,"./utils":14}],5:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r["default"]=void 0;var n=function t(e,r){this.boardState=e;this.intersection=r;Object.freeze(this)};n.prototype={diagonals:function r(){var n=this;var r=[];var t=[];var i=[];if(this.intersection.x>0){t.push(this.intersection.x-1)}if(this.intersection.x<this.boardState.boardSize-1){t.push(this.intersection.x+1)}if(this.intersection.y>0){i.push(this.intersection.y-1)}if(this.intersection.y<this.boardState.boardSize-1){i.push(this.intersection.y+1)}t.forEach(function(e){i.forEach(function(t){r.push(n.boardState.intersectionAt(t,e))})});return r},isFalse:function t(){if(!this.intersection.isEmpty()){return false}var e=this.diagonals();var r=e.length<=2;var n=this.neighbors();var i=n.filter(function(t){return!t.isEmpty()});if(r&&i.length<1){return false}if(!r&&i.length<2){return false}var o=e.filter(function(t){return!t.isEmpty()&&!t.sameColorAs(i[0])});if(r){return o.length>=1}else{return o.length>=2}},neighbors:function t(){return this.boardState.neighborsFor(this.intersection.y,this.intersection.x)},filledColor:function t(){if(!this.isFalse()){throw new Error("Attempting to find filled color for a non-false eye")}return this.neighbors()[0].value}};var i=r["default"]=n},{}],6:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r["default"]=void 0;var b=n(t("./dom-renderer"));var S=n(t("./svg-renderer"));var i=n(t("./null-renderer"));var g=n(t("./board-state"));var E=n(t("./ruleset"));var _=n(t("./scorer"));function n(t){return t&&t.__esModule?t:{default:t}}function h(t,e){return l(t)||u(t,e)||a(t,e)||o()}function o(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function a(t,e){if(!t)return;if(typeof t==="string")return s(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor)r=t.constructor.name;if(r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s(t,e)}function s(t,e){if(e==null||e>t.length)e=t.length;for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function u(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);u=!0);}catch(t){l=!0,i=t}finally{try{if(!u&&null!=r["return"]&&(a=r["return"](),Object(a)!==a))return}finally{if(l)throw i}}return s}}function l(t){if(Array.isArray(t))return t}function w(t){"@babel/helpers - typeof";return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w(t)}var f=["element","boardSize","scoring","handicapStones","koRule","komi","_hooks","fuzzyStonePlacement","renderer","freeHandicapPlacement","bluePosition"];var c=function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this._validateOptions(e);this._defaultBoardSize=19;this.boardSize=null;this._moves=[];this.callbacks={postRender:function t(){}};this._boardElement=e["element"];this._defaultScoring="territory";this._defaultKoRule="simple";this._defaultRenderer="svg";this._deadPoints=[];this._bluePosition=e["bluePosition"];console.log("this._bluePosition =",this._bluePosition);this._setup(e)};c.prototype={_validateOptions:function t(e){for(var r in e){if(e.hasOwnProperty(r)){if(f.indexOf(r)<0){throw new Error("Unrecognized game option: "+r)}if(typeof e[r]==="undefined"||e[r]===null){throw new Error("Game option ".concat(r," must not be set as null or undefined"))}}}},_configureOptions:function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},r=e.bluePosition,n=r===void 0?this._bluePosition:r,i=e.boardSize,o=i===void 0?this._defaultBoardSize:i,a=e.komi,s=a===void 0?0:a,u=e.handicapStones,l=u===void 0?0:u,f=e.freeHandicapPlacement,c=f===void 0?false:f,d=e.scoring,h=d===void 0?this._defaultScoring:d,v=e.koRule,p=v===void 0?this._defaultKoRule:v,m=e.renderer,y=m===void 0?this._defaultRenderer:m;if(typeof o!=="number"){throw new Error("Board size must be a number, but was: "+w(o))}if(typeof l!=="number"){throw new Error("Handicap stones must be a number, but was: "+w(o))}if(l>0&&o!==9&&o!==13&&o!==19){throw new Error("Handicap stones not supported on sizes other than 9x9, 13x13 and 19x19")}if(l<0||l===1||l>9){throw new Error("Only 2 to 9 handicap stones are supported")}if(o>19){throw new Error("cannot generate a board size greater than 19")}this.boardSize=o;this.handicapStones=l;this._freeHandicapPlacement=c;this._scorer=new _["default"]({scoreBy:h,komi:s});this._rendererChoice={dom:b["default"],svg:S["default"]}[y];if(!this._rendererChoice){throw new Error("Unknown renderer: "+y)}this._ruleset=new E["default"]({koRule:p});if(this._freeHandicapPlacement){this._initialState=g["default"]._initialFor(o,0,n)}else{this._initialState=g["default"]._initialFor(o,l,n)}},_stillPlayingHandicapStones:function t(){return this._freeHandicapPlacement&&this.handicapStones>0&&this._moves.length<this.handicapStones},_setup:function t(){var n=this;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this._validateOptions(e);this._configureOptions(e);if(this._boardElement){var r={handleClick:function t(e,r){if(n.isOver()){n.toggleDeadAt(e,r)}else{n.playAt(e,r)}},hoverValue:function t(e,r){if(!n.isOver()&&!n.isIllegalAt(e,r)){return n.currentPlayer()}},gameIsOver:function t(){return n.isOver()}};this.renderer=new this._rendererChoice(this._boardElement,{hooks:e["_hooks"]||r,options:{fuzzyStonePlacement:e["fuzzyStonePlacement"]}})}else{this.renderer=new i["default"]}this.render()},intersectionAt:function t(e,r){return this.currentState().intersectionAt(e,r)},intersections:function t(){return this.currentState().intersections},deadStones:function t(){return this._deadPoints},coordinatesFor:function t(e,r){return this.currentState().xCoordinateFor(r)+this.currentState().yCoordinateFor(e)},currentPlayer:function t(){if(this._stillPlayingHandicapStones()){return"black"}return this.currentState().nextColor()},isWhitePlaying:function t(){return this.currentPlayer()==="white"},isBlackPlaying:function t(){return this.currentPlayer()==="black"},score:function t(){return this._scorer.score(this)},currentState:function t(){return this._moves[this._moves.length-1]||this._initialState},moveNumber:function t(){return this.currentState().moveNumber},playAt:function t(e,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},i=n.render,o=i===void 0?true:i;if(this.isIllegalAt(e,r)){return false}var a=this.currentState().playAt(e,r,this.currentPlayer());var s=a,u=s.koPoint;if(u&&!this._ruleset._isKoViolation(u.y,u.x,a,this._moves.concat(a))){a=a.copyWithAttributes({koPoint:null})}this._moves.push(a);if(o){this.render()}return true},pass:function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},r=e.render,n=r===void 0?true:r;if(this.isOver()){return false}var i=this.currentState().playPass(this.currentPlayer());this._moves.push(i);if(n){this.render()}return true},isOver:function t(){if(this._moves.length<2){return false}var e=this._moves[this._moves.length-1];var r=this._moves[this._moves.length-2];return e.pass&&r.pass},markDeadAt:function t(e,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},i=n.render,o=i===void 0?true:i;if(this._isDeadAt(e,r)){return true}return this._setDeadStatus(e,r,true,{render:o})},unmarkDeadAt:function t(e,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},i=n.render,o=i===void 0?true:i;if(!this._isDeadAt(e,r)){return true}return this._setDeadStatus(e,r,false,{render:o})},toggleDeadAt:function t(e,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},i=n.render,o=i===void 0?true:i;return this._setDeadStatus(e,r,!this._isDeadAt(e,r),{render:o})},_setDeadStatus:function t(e,r,n){var i=this;var o=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{},a=o.render,s=a===void 0?true:a;var u=this.intersectionAt(e,r);if(u.isEmpty()){return}var l=[];var f=this.currentState().partitionTraverse(u,function(t){return t.isEmpty()||t.sameColorAs(u)}),c=h(f,1),d=c[0];d.forEach(function(t){if(!t.isEmpty()){l.push(t)}});l.forEach(function(e){if(n){i._deadPoints.push({y:e.y,x:e.x})}else{i._deadPoints=i._deadPoints.filter(function(t){return!(t.y===e.y&&t.x===e.x)})}});if(s){this.render()}return true},_isDeadAt:function t(e,r){return this._deadPoints.some(function(t){return t.y===e&&t.x===r})},isIllegalAt:function t(e,r){return this._ruleset.isIllegal(e,r,this)},territory:function t(){if(!this.isOver()){return{black:[],white:[]}}return this._scorer.territory(this)},undo:function t(){this._moves.pop();this.render()},render:function t(){if(!this.isOver()){this._deadPoints=[]}this.renderer.render(this.currentState(),{territory:this.territory(),deadStones:this.deadStones()});this.callbacks.postRender(this)}};var d=r["default"]=c},{"./board-state":2,"./dom-renderer":4,"./null-renderer":8,"./ruleset":11,"./scorer":12,"./svg-renderer":13}],7:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r["default"]=void 0;var n=function t(e,r,n){this.y=e;this.x=r;this.value=n||"empty";Object.freeze(this)};n.prototype={isOccupiedWith:function t(e){if(this.isEmpty()){return false}return this.value===e},isBlack:function t(){return this.value==="black"},isWhite:function t(){return this.value==="white"},isBlue:function t(){return this.value==="blue"},isEmpty:function t(){return this.value==="empty"},sameColorAs:function t(e){return this.value===e.value}};var i=r["default"]=n},{}],8:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r["default"]=n;function n(){this.setup=function(){};this.render=function(){};this.renderTerritory=function(){}}},{}],9:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r["default"]=void 0;var u=n(t("./utils"));function n(t){return t&&t.__esModule?t:{default:t}}function l(t,e){return f(t)||s(t,e)||o(t,e)||i()}function i(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(t,e){if(!t)return;if(typeof t==="string")return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor)r=t.constructor.name;if(r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(t,e)}function a(t,e){if(e==null||e>t.length)e=t.length;for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function s(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);u=!0);}catch(t){l=!0,i=t}finally{try{if(!u&&null!=r["return"]&&(a=r["return"](),Object(a)!==a))return}finally{if(l)throw i}}return s}}function f(t){if(Array.isArray(t))return t}var c=function t(e,r){this.boardState=e;this.intersections=r;this._computed={};Object.freeze(this)};c._startingAt=function(t,e,r){var n=t.intersectionAt(e,r);var i=t.partitionTraverse(n,function(t){return t.sameColorAs(n)}),o=l(i,2),a=o[0],s=o[1];return[a,s]};c.allFor=function(o){var a=[];var s=[];o.intersections.forEach(function(e){if(a.indexOf(e)>-1){}else{var t=o.partitionTraverse(e,function(t){return t.sameColorAs(e)}),r=l(t,2),n=r[0],i=r[1];s.push(new c(o,n));a=a.concat(n)}});return s};c.merge=function(t,e){var r=[e];var n=-1;while(r.length!==n){n=r.length;r=t.filter(function(t){return t.isEmpty()&&t.isTerritory()&&t.territoryColor()===e.territoryColor()&&t.expandedBoundaryStones().some(function(e){return r.some(function(t){return t.expandedBoundaryStones().indexOf(e)>-1})})})}return r};c.prototype={isEmpty:function t(){return this.intersections[0].isEmpty()},isTerritory:function t(){var e=this.intersections[0];if(!e.isEmpty()){return false}var r=c._startingAt(this.boardState,e.y,e.x),n=l(r,2),i=n[0],o=n[1];var a=u["default"].unique(o.map(function(t){return t.value}));var t=a.length===1&&a[0]!=="empty";return t},territoryColor:function t(){var e=this.intersections[0];var r=c._startingAt(this.boardState,e.y,e.x),n=l(r,2),i=n[0],o=n[1];var a=u["default"].unique(o.map(function(t){return t.value}));var s=a.length===1&&a[0]!=="empty";if(!e.isEmpty()||!s){throw new Error("Attempted to obtain territory color for something that isn't territory, region containing "+e.y+","+e.x)}else{return a[0]}},isBlack:function t(){return this.territoryColor()==="black"},isWhite:function t(){return this.territoryColor()==="white"},isNeutral:function t(){return!this.intersections[0].isBlack()&&!this.intersections[0].isWhite()&&!this.isTerritory()},exterior:function t(){var e=this;return this.boardState.intersections.filter(function(t){return e.intersections.indexOf(t)<0&&e.boardState.neighborsFor(t.y,t.x).some(function(t){return e.intersections.indexOf(t)>-1})})},boundaryStones:function t(){var e=this;if(this._computed.boundaryStones){return this._computed.boundaryStones}if(!this.isEmpty()){throw new Error("Attempted to obtain boundary stones for non-empty region")}this._computed.boundaryStones=this.exterior().filter(function(t){return!t.sameColorAs(e.intersections[0])});return this._computed.boundaryStones},expandedBoundaryStones:function t(){if(this._computed.expandedBoundaryStones){return this._computed.expandedBoundaryStones}var e=this.boundaryStones();var r=c.allFor(this.boardState).filter(function(t){return t.intersections.some(function(t){return e.indexOf(t)>-1})});this._computed.expandedBoundaryStones=u["default"].flatMap(r,function(t){return t.intersections});return this._computed.expandedBoundaryStones},lengthOfTerritoryBoundary:function t(){var e=this;var r=this.intersections.filter(function(t){return t.y===0||t.y===e.boardState.boardSize-1||t.x===0||t.x===e.boardState.boardSize-1});var n=this.intersections.filter(function(t){return t.y%e.boardState.boardSize-1===0&&t.x%e.boardState.boardSize-1===0});return this.boundaryStones().length+r.length+n.length},containsSquareFour:function t(){var u=this;return this.intersections.some(function(s){return[[0,0],[0,1],[1,0],[1,1]].every(function(t){var e=l(t,2),r=e[0],n=e[1];var i=s.y+r;var o=s.x+n;var a=i>=0&&i<u.boardState.boardSize&&o>=0&&o<u.boardState.boardSize;return a&&u.boardState.intersectionAt(i,o).sameColorAs(s)})})},containsCurvedFour:function t(){var u=this;return this.intersections.some(function(s){return[[[0,0],[1,0],[2,0],[2,1]],[[-1,2],[0,0],[0,1],[0,2]],[[0,0],[0,1],[1,1],[2,1]],[[-1,0],[-1,1],[-1,2],[0,0]],[[-2,1],[-1,1],[0,0],[0,1]],[[0,0],[1,0],[1,1],[1,2]],[[0,-1],[0,0],[1,-1],[2,-1]],[[-1,-2],[-1,-1],[-1,0],[0,0]]].some(function(t){return t.every(function(t){var e=l(t,2),r=e[0],n=e[1];var i=s.y+r;var o=s.x+n;var a=i>=0&&i<u.boardState.boardSize&&o>=0&&o<u.boardState.boardSize;return a&&u.boardState.intersectionAt(i,o).sameColorAs(s)})})})},numberOfEyes:function t(){if(!this.intersections[0].isEmpty()){throw new Error("Unexpected calculation of number of eyes for a non-empty region containing "+this.intersections[0].y+","+this.intersections[0].x)}var e=this.lengthOfTerritoryBoundary();if(e<2){throw new Error("Unexpected boundary length of "+e+" for region including "+this.intersections[0].y+","+this.intersections[0].x)}if(e>=10){return 2}var r;switch(e){case 2:case 3:case 4:case 5:case 6:r=1;break;case 7:r=1.5;break;case 8:if(this.containsSquareFour()){r=1}else if(this.containsCurvedFour()){r=2}else{r=1.5}break;case 9:if(this.containsSquareFour()){r=1.5}else{r=2}break;default:throw new Error("unhandled boundary length "+e)}return r}};var d=r["default"]=c},{"./utils":14}],10:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r["default"]=void 0;var p=n(t("./utils"));function n(t){return t&&t.__esModule?t:{default:t}}function m(t,e){return u(t)||s(t,e)||o(t,e)||i()}function i(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(t,e){if(!t)return;if(typeof t==="string")return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor)r=t.constructor.name;if(r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(t,e)}function a(t,e){if(e==null||e>t.length)e=t.length;for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function s(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);u=!0);}catch(t){l=!0,i=t}finally{try{if(!u&&null!=r["return"]&&(a=r["return"](),Object(a)!==a))return}finally{if(l)throw i}}return s}}function u(t){if(Array.isArray(t))return t}var l=function t(e,r){var n=r.hooks,i=r.options;this.INTERSECTION_GAP_SIZE=28;this.GUTTER_MARGIN=this.INTERSECTION_GAP_SIZE-3;this.BASE_MARGIN=this.INTERSECTION_GAP_SIZE-10;this.hasCoordinates=e.hasAttribute("data-include-coordinates");this.MARGIN=this.hasCoordinates?this.BASE_MARGIN+this.GUTTER_MARGIN:this.BASE_MARGIN;this.boardElement=e;this.grid=[];this.hooks=n||{};this._options=i||{};this._initialized=false;if(this._options["fuzzyStonePlacement"]){p["default"].addClass(e,"tenuki-fuzzy-placement");p["default"].removeClass(e,"tenuki-board-flat");p["default"].addClass(e,"tenuki-board-nonflat");this.smallerStones=true}this.flatStones=p["default"].hasClass(e,"tenuki-board-flat");if(!this.flatStones){p["default"].addClass(e,"tenuki-board-nonflat")}};l.hoshiPositionsFor=function(t){var e=[];if(t<7){if(t>1&&t%2===1){var r={};r.top=(t-1)/2;r.left=r.top;e.push(r)}else{}}else{var n=t>11?3:2;for(var i=0;i<3;i++){for(var o=0;o<3;o++){if((t===7||t%2===0)&&(i===1||o===1)){continue}var a={};if(i===0){a.top=n}if(i===1){a.top=(t+1)/2-1}if(i===2){a.top=t-n-1}if(o===0){a.left=n}if(o===1){a.left=(t+1)/2-1}if(o===2){a.left=t-n-1}e.push(a)}}}return e};l.prototype={_setup:function t(e){var r=this;var n=this.boardElement;r.BOARD_LENGTH=2*this.MARGIN+(e.boardSize-1)*(this.INTERSECTION_GAP_SIZE+1);var i=p["default"].createElement("div",{class:"tenuki-inner-container"});r.innerContainer=i;p["default"].appendElement(n,i);var o=p["default"].createElement("div",{class:"tenuki-zoom-container"});r.zoomContainer=o;p["default"].appendElement(i,o);r.cancelZoomElement=p["default"].createElement("div",{class:"cancel-zoom"});var a=p["default"].createElement("div",{class:"cancel-zoom-backdrop"});p["default"].addEventListener(r.cancelZoomElement,"click",function(t){t.preventDefault();r.zoomOut();return false});p["default"].addEventListener(a,"click",function(t){t.preventDefault();r.zoomOut();return false});p["default"].appendElement(i,r.cancelZoomElement);p["default"].appendElement(i,a);var s=function t(e,r){var n=false;var i=function t(){if(n){return}n=true;window.requestAnimationFrame(function(){window.dispatchEvent(new CustomEvent(r));n=false})};window.addEventListener(e,i)};s("resize","optimizedResize");var u=this.generateBoard(e,{hasCoordinates:this.hasCoordinates,smallerStones:this.smallerStones,flatStones:this.flatStones});p["default"].appendElement(o,u);window.requestAnimationFrame(function(){o.style.willChange="transform";r.computeSizing()});window.addEventListener("optimizedResize",function(){r.computeSizing()});r.touchmoveChangedTouch=null;r.touchstartEventHandler=r.handleTouchStart.bind(r);r.touchmoveEventHandler=r.handleTouchMove.bind(r);r.touchendEventHandler=r.handleTouchEnd.bind(r);p["default"].addEventListener(r.innerContainer,"touchstart",r.touchstartEventHandler);p["default"].addEventListener(r.innerContainer,"touchend",r.touchendEventHandler);p["default"].addEventListener(r.innerContainer,"touchmove",r.touchmoveEventHandler)},computeSizing:function t(){var e=this;var r=this.innerContainer;var n=this.zoomContainer;var i=this.boardElement;r.style.height="";r.style.width="";n.style.height="";n.style.width="";r.style.transform="";i.style.width="";i.style.height="";e._touchEventFired=null;r.style.width=e.BOARD_LENGTH+"px";r.style.height=e.BOARD_LENGTH+"px";n.style.width=e.BOARD_LENGTH+"px";n.style.height=e.BOARD_LENGTH+"px";var o=r.parentNode.clientWidth/r.clientWidth;var a=r.parentNode.clientHeight/r.clientHeight;var s=Math.min(o,a);if(s>0){if(s<1){p["default"].addClass(i,"tenuki-scaled")}else{p["default"].removeClass(i,"tenuki-scaled")}if(s<1||s>1){r.style["transform-origin"]="top left";r.style.transform="scale3d("+s+", "+s+", 1)"}}i.style.width=r.getBoundingClientRect().width+"px";i.style.height=r.getBoundingClientRect().height+"px";n.style.willChange="";window.requestAnimationFrame(function(){n.style.willChange="transform"})},addIntersectionEventListeners:function t(n,i,o){var a=this;p["default"].addEventListener(n,"mouseenter",function(){var t=i;var e=o;var r=a.hooks.hoverValue(t,e);if(r){p["default"].addClass(n,"hovered");p["default"].addClass(n,r)}});p["default"].addEventListener(n,"mouseleave",function(){if(p["default"].hasClass(this,"hovered")){p["default"].removeClass(n,"hovered");p["default"].removeClass(n,"black");p["default"].removeClass(n,"white")}a.resetTouchedPoint()});p["default"].addEventListener(n,"click",function(){var t=i;var e=o;if(!a._touchEventFired||document.body.clientWidth/window.innerWidth>1||a.hooks.gameIsOver()){a.hooks.handleClick(t,e);return}if(a.touchedPoint){if(n===a.touchedPoint){a.hooks.handleClick(t,e)}else{a.showPossibleMoveAt(n,t,e)}}else{a.showPossibleMoveAt(n,t,e)}})},handleTouchStart:function t(e){var r=this;r._touchEventFired=true;if(e.touches.length>1){if(r.zoomedIn){e.preventDefault()}return}if(!r.zoomedIn){return}var n=e.changedTouches[0].clientX;var i=e.changedTouches[0].clientY;r.dragStartX=n;r.dragStartY=i;r.zoomContainer.style.transition="none";r.animationFrameRequestID=window.requestAnimationFrame(r.processDragDelta.bind(r))},handleTouchMove:function t(e){var r=this;if(e.touches.length>1){return}if(!r.zoomedIn){return true}e.preventDefault();r.touchmoveChangedTouch=e.changedTouches[0];r.moveInProgress=true},handleTouchEnd:function t(e){var r=this;if(e.touches.length>1){return}if(!r.zoomedIn){return}r.zoomContainer.style.transition="";if(!r.moveInProgress){return}r.translateY=r.lastTranslateY;r.translateX=r.lastTranslateX;r.moveInProgress=false;r.touchmoveChangedTouch=null;window.cancelAnimationFrame(r.animationFrameRequestID)},processDragDelta:function t(){var e=this;if(!e.touchmoveChangedTouch){e.animationFrameRequestID=window.requestAnimationFrame(e.processDragDelta.bind(e));return}var r=e.innerContainer;var n=e.touchmoveChangedTouch.clientX;var i=e.touchmoveChangedTouch.clientY;var o=n-e.dragStartX;var a=i-e.dragStartY;var s=e.translateY+a/2.5;var u=e.translateX+o/2.5;if(s>.5*r.clientHeight-e.MARGIN){s=.5*r.clientHeight-e.MARGIN}if(u>.5*r.clientWidth-e.MARGIN){u=.5*r.clientWidth-e.MARGIN}if(s<-.5*r.clientHeight+e.MARGIN){s=-.5*r.clientHeight+e.MARGIN}if(u<-.5*r.clientWidth+e.MARGIN){u=-.5*r.clientWidth+e.MARGIN}e.zoomContainer.style.transform="translate3d("+2.5*u+"px, "+2.5*s+"px, 0) scale3d(2.5, 2.5, 1)";e.lastTranslateX=u;e.lastTranslateY=s;e.animationFrameRequestID=window.requestAnimationFrame(e.processDragDelta.bind(e))},showPossibleMoveAt:function t(e,r,n){var i=this;var o=this.boardElement;var a=this.zoomContainer;i.zoomContainerHeight=i.zoomContainerHeight||a.clientHeight;i.zoomContainerWidth=i.zoomContainerWidth||a.clientWidth;i.touchedPoint=e;if(p["default"].hasClass(o,"tenuki-scaled")){var s=r*(this.INTERSECTION_GAP_SIZE+1);var u=n*(this.INTERSECTION_GAP_SIZE+1);var l=.5*i.zoomContainerHeight-s-i.MARGIN;var f=.5*i.zoomContainerWidth-u-i.MARGIN;a.style.transform="translate3d("+2.5*f+"px, "+2.5*l+"px, 0) scale3d(2.5, 2.5, 1)";i.translateY=l;i.translateX=f;p["default"].addClass(i.cancelZoomElement,"visible");i.zoomedIn=true}},resetTouchedPoint:function t(){var e=this;e.touchedPoint=null},zoomOut:function t(){var e=this;this.resetTouchedPoint();e.zoomContainer.style.transform="";e.zoomContainer.style.transition="";e.dragStartX=null;e.dragStartY=null;e.translateY=null;e.translateX=null;e.lastTranslateX=null;e.lastTranslateY=null;p["default"].removeClass(e.cancelZoomElement,"visible");e.zoomedIn=false},render:function t(e){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},i=n.territory,o=n.deadStones;if(!this._initialized){this._setup(e);this._initialized=true}this.resetTouchedPoint();this.renderStonesPlayed(e.intersections);var a=e.playedPoint;this.updateMarkerPoints({playedPoint:a,koPoint:e.koPoint});if(this._options["fuzzyStonePlacement"]&&a){var s=["v-shift-up","v-shift-upup","v-shift-down","v-shift-downdown","v-shift-none"];var u=["h-shift-left","h-shift-leftleft","h-shift-right","h-shift-rightright","h-shift-none"];var l=s.concat(u);var f=l.some(function(t){return p["default"].hasClass(r.grid[a.y][a.x],t)});if(!f){var c=p["default"].cartesianProduct(s,u);var d=m(c[Math.floor(Math.random()*c.length)],2),h=d[0],v=d[1];[[-1,0],[0,-1],[0,1],[1,0]].forEach(function(t){var e=m(t,2),s=e[0],u=e[1];if(r.grid[a.y+s]&&r.grid[a.y+s][a.x+u]){var l=r.grid[a.y+s][a.x+u];if(!p["default"].hasClass(l,"empty")){[[-1,0,"v-shift-downdown","v-shift-up","v-shift-down"],[-1,0,"v-shift-downdown","v-shift-upup","v-shift-none"],[-1,0,"v-shift-down","v-shift-upup","v-shift-none"],[1,0,"v-shift-upup","v-shift-down","v-shift-up"],[1,0,"v-shift-upup","v-shift-downdown","v-shift-none"],[1,0,"v-shift-up","v-shift-downdown","v-shift-none"],[0,-1,"h-shift-rightright","h-shift-left","h-shift-right"],[0,-1,"h-shift-rightright","h-shift-leftleft","h-shift-none"],[0,-1,"h-shift-right","h-shift-leftleft","h-shift-none"],[0,1,"h-shift-leftleft","h-shift-right","h-shift-left"],[0,1,"h-shift-leftleft","h-shift-rightright","h-shift-none"],[0,1,"h-shift-left","h-shift-rightright","h-shift-none"]].forEach(function(t){var e=m(t,5),r=e[0],n=e[1],i=e[2],o=e[3],a=e[4];if(s===r&&u===n&&p["default"].hasClass(l,i)&&(h===o||v===o)){p["default"].removeClass(l,i);p["default"].addClass(l,a)}})}}});p["default"].addClass(this.grid[a.y][a.x],h);p["default"].addClass(this.grid[a.y][a.x],v)}}if(o.length>0||i.black.length>0||i.white.length>0){this.renderTerritory(i,o)}},renderStonesPlayed:function t(e){var r=this;e.forEach(function(t){r.renderIntersection(t)})},updateMarkerPoints:function t(e){var r=e.playedPoint,n=e.koPoint;var i=this;if(n){p["default"].addClass(i.grid[n.y][n.x],"ko")}if(r){p["default"].addClass(i.grid[r.y][r.x],"played")}},renderIntersection:function t(e){var r=this;var n=r.grid[e.y][e.x];var i=["intersection"];if(e.isEmpty()){i.push("empty")}else{i.push("occupied");if(e.isBlack()){i.push("black")}else if(e.isBlue()){i.push("blue")}else{i.push("white")}var o=["v-shift-up","v-shift-upup","v-shift-down","v-shift-downdown","v-shift-none","h-shift-left","h-shift-leftleft","h-shift-right","h-shift-rightright","h-shift-none"];o.forEach(function(t){if(p["default"].hasClass(n,t)){i.push(t)}})}this.setIntersectionClasses(n,e,i)},renderTerritory:function t(e,r){var n=this;p["default"].flatten(this.grid).forEach(function(t){p["default"].removeClass(t,"territory-black");p["default"].removeClass(t,"territory-white");p["default"].removeClass(t,"dead")});r.forEach(function(t){p["default"].addClass(n.grid[t.y][t.x],"dead")});e.black.forEach(function(t){p["default"].addClass(n.grid[t.y][t.x],"territory-black")});e.white.forEach(function(t){p["default"].addClass(n.grid[t.y][t.x],"territory-white")})}};var f=r["default"]=l},{"./utils":14}],11:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r["default"]=void 0;var n=["simple","positional-superko","situational-superko","natural-situational-superko"];var i=function t(e){var r=e.koRule;this.koRule=r;if(n.indexOf(this.koRule)<0){throw new Error("Unknown ko rule: "+r)}Object.freeze(this)};i.prototype={isIllegal:function t(e,r,n){var i=n.currentState();var o=i.intersectionAt(e,r);var a=!o.isEmpty()||this._wouldBeSuicide(e,r,i)||this._isKoViolation(e,r,i,n._moves);return a},_isKoViolation:function t(e,r,n,i){var o=false;if(this.koRule==="simple"){var a=n._simpleKoPoint();o=Boolean(a)&&e===a.y&&r===a.x}else{var s=n.playAt(e,r,n.nextColor());var u=function t(e){return i.length>0&&i.some(function(t){return e(t)&&t.positionSameAs(s)})};if(this.koRule==="positional-superko"){o=u(function(){return true})}else if(this.koRule==="situational-superko"){o=u(function(t){return t.color===s.color})}else if(this.koRule==="natural-situational-superko"){o=u(function(t){return!t.pass&&t.color===s.color})}else{throw new Error("Unimplemented ko rule ".concat(this.koRule))}}return o},_wouldBeSuicide:function t(e,r,n){var i=n.nextColor();var o=n.intersectionAt(e,r);var a=o.isEmpty()&&n.neighborsFor(o.y,o.x).filter(function(t){return t.isEmpty()}).length===0;if(!a){return false}var s=n.neighborsFor(o.y,o.x).some(function(t){var e=n.inAtari(t.y,t.x);var r=t.isOccupiedWith(i);return r&&!e});if(s){return false}var u=n.neighborsFor(o.y,o.x).some(function(t){var e=n.inAtari(t.y,t.x);var r=!t.isOccupiedWith(i);return r&&e});if(u){return false}return true}};var o=r["default"]=i},{}],12:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r["default"]=void 0;var l=n(t("./utils"));var s=n(t("./intersection"));var f=n(t("./region"));var u=n(t("./eye-point"));function n(t){return t&&t.__esModule?t:{default:t}}var c=function t(e){return e.currentState()._withoutIntersectionsMatching(function(t){return e._isDeadAt(t.y,t.x)})};var d=function t(e){var r=f["default"].allFor(e);var n=r.filter(function(t){return t.isNeutral()});if(r.length===0||n.length===0){return e}var a={};n.forEach(function(t){var i=null;var o=null;t.intersections.forEach(function(t){i=i||t.x;i=i||t.y;var e=Math.abs(t.y-o)+Math.abs(t.x-i);var r=["black","white"][e%2];var n=new s["default"](t.y,t.x,r);a[t.y]=a[t.y]||[];a[t.y][t.x]=n})});var i=e.intersections.map(function(t){if(a[t.y]&&a[t.y][t.x]){return a[t.y][t.x]}else{return t}});return e._withNewPoints(i)};var h=function t(e){var r=f["default"].allFor(e).filter(function(t){return t.isTerritory()});var n=l["default"].flatMap(r,function(t){return t.intersections}).filter(function(t){return new u["default"](e,t).isFalse()});var o=n.filter(function(t){return e.neighborsFor(t.y,t.x).some(function(t){return e.inAtari(t.y,t.x)})});var a=e;var i=function t(){var e=a.intersections.map(function(t){if(o.indexOf(t)>-1){return new s["default"](t.y,t.x,new u["default"](a,t).filledColor())}else{return t}});a=a._withNewPoints(e);var r=d(a);var n=f["default"].allFor(r).filter(function(t){return t.isTerritory()});var i=l["default"].flatMap(n,function(t){return t.intersections}).filter(function(t){return new u["default"](r,t).isFalse()});o=i.filter(function(t){return a.neighborsFor(t.y,t.x).some(function(t){return a.inAtari(t.y,t.x)})})};while(o.length>0){i()}return a};var i=Object.freeze({score:function t(e){var r=e.deadStones().filter(function(t){return e.intersectionAt(t.y,t.x).isBlack()});var n=e.deadStones().filter(function(t){return e.intersectionAt(t.y,t.x).isWhite()});var i=e.territory();var o=e.currentState();return{black:i.black.length+o.whiteStonesCaptured+n.length,white:i.white.length+o.blackStonesCaptured+r.length}},territory:function t(e){var r=c(e);var n=d(r);var i=h(n);var o=f["default"].allFor(i).filter(function(t){return t.isTerritory()});var a=o.filter(function(t){var e=f["default"].merge(o,t);var r=e.map(function(t){return Math.ceil(t.numberOfEyes())});return r.length>0&&r.reduce(function(t,e){return t+e})>=2});var s=a.filter(function(t){return t.isBlack()});var u=a.filter(function(t){return t.isWhite()});return{black:l["default"].flatMap(s,function(t){return t.intersections}).map(function(t){return{y:t.y,x:t.x}}),white:l["default"].flatMap(u,function(t){return t.intersections}).map(function(t){return{y:t.y,x:t.x}})}}});var o=Object.freeze({score:function t(e){var r=e.intersections().filter(function(t){return t.isBlack()&&!e._isDeadAt(t.y,t.x)});var n=e.intersections().filter(function(t){return t.isWhite()&&!e._isDeadAt(t.y,t.x)});var i=e.territory();return{black:i.black.length+r.length,white:i.white.length+n.length}},territory:function t(e){var r=f["default"].allFor(c(e));var n=r.filter(function(t){return t.isTerritory()});var i=n.filter(function(t){return t.isBlack()});var o=n.filter(function(t){return t.isWhite()});return{black:l["default"].flatMap(i,function(t){return t.intersections}).map(function(t){return{y:t.y,x:t.x}}),white:l["default"].flatMap(o,function(t){return t.intersections}).map(function(t){return{y:t.y,x:t.x}})}}});var a=function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},r=e.scoreBy,n=e.komi;this._strategy={area:o,territory:i,equivalence:o}[r];this._komi=n;if(!this._strategy){throw new Error("Unknown scoring type: "+r)}if(this._komi===null||typeof this._komi==="undefined"){throw new Error("Error initializing scorer without a komi value")}if(typeof this._komi!=="number"){throw new Error("Komi value given is not a number: "+n)}this._usePassStones=r==="equivalence";Object.freeze(this)};a.prototype={score:function t(e){var r=this._strategy.score(e);r.white+=this._komi;if(this._usePassStones){var n=e.currentState().color!=="white";return{black:r.black+e.currentState().whitePassStones+(n?1:0),white:r.white+e.currentState().blackPassStones}}else{return r}},territory:function t(e){return this._strategy.territory(e)},usingPassStones:function t(){return this._usePassStones}};var v=r["default"]=a},{"./eye-point":5,"./intersection":7,"./region":9,"./utils":14}],13:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r["default"]=void 0;var N=n(t("./utils"));var T=n(t("./renderer"));function n(t){return t&&t.__esModule?t:{default:t}}var i=function t(e,r){var n=r.hooks,i=r.options;T["default"].call(this,e,{hooks:n,options:i});N["default"].addClass(e,"tenuki-svg-renderer")};i.prototype=Object.create(T["default"].prototype);i.prototype.constructor=i;var z={};var a=function t(r,n,e){var i=e.hasCoordinates,o=e.smallerStones,a=e.flatStones;var s=[n.boardSize,i,o,a].toString();var u=N["default"].createSVGElement("svg");var l=N["default"].createSVGElement("defs");N["default"].appendElement(u,l);var f=N["default"].createSVGElement("radialGradient",{attributes:{id:r.blackGradientID,cy:"15%",r:"50%"}});N["default"].appendElement(f,N["default"].createSVGElement("stop",{attributes:{offset:"0%","stop-color":"hsl(0, 0%, 38%)"}}));N["default"].appendElement(f,N["default"].createSVGElement("stop",{attributes:{offset:"100%","stop-color":"#39363D"}}));N["default"].appendElement(l,f);var c=N["default"].createSVGElement("radialGradient",{attributes:{id:r.whiteGradientID,cy:"15%",r:"50%"}});N["default"].appendElement(c,N["default"].createSVGElement("stop",{attributes:{offset:"0%","stop-color":"#FFFFFF"}}));N["default"].appendElement(c,N["default"].createSVGElement("stop",{attributes:{offset:"100%","stop-color":"#fafdfc"}}));N["default"].appendElement(l,c);var d=N["default"].createSVGElement("radialGradient",{attributes:{id:r.blueGradientID}});N["default"].appendElement(d,N["default"].createSVGElement("stop",{attributes:{offset:"100%","stop-color":"#ebc98a"}}));N["default"].appendElement(l,d);var h=N["default"].createSVGElement("g",{attributes:{class:"contents",transform:"translate(".concat(r.MARGIN,", ").concat(r.MARGIN,")")}});N["default"].appendElement(u,h);var v;if(z[s]){v=N["default"].clone(z[s])}else{v=N["default"].createSVGElement("g",{attributes:{class:"lines"}});for(var p=0;p<n.boardSize-1;p++){for(var m=0;m<n.boardSize-1;m++){var y=N["default"].createSVGElement("rect",{attributes:{y:p*(r.INTERSECTION_GAP_SIZE+1)-.5,x:m*(r.INTERSECTION_GAP_SIZE+1)-.5,width:r.INTERSECTION_GAP_SIZE+1,height:r.INTERSECTION_GAP_SIZE+1,class:"line-box"}});N["default"].appendElement(v,y)}}z[s]=v}N["default"].appendElement(h,v);var b=N["default"].createSVGElement("g",{attributes:{class:"hoshi"}});N["default"].appendElement(h,b);T["default"].hoshiPositionsFor(n.boardSize).forEach(function(t){var e=N["default"].createSVGElement("circle",{attributes:{class:"hoshi",cy:t.top*(r.INTERSECTION_GAP_SIZE+1)-.5,cx:t.left*(r.INTERSECTION_GAP_SIZE+1)-.5,r:2}});N["default"].appendElement(b,e)});if(i){var S=N["default"].createSVGElement("g",{attributes:{class:"coordinates",transform:"translate(".concat(r.MARGIN,", ").concat(r.MARGIN,")")}});var g=function t(e){[16/2+1-(16+16/2+16/(2*2)+16/(2*2*2)),16/2+1+(16+16/2)+(n.boardSize-1)*(r.INTERSECTION_GAP_SIZE+1)].forEach(function(t){N["default"].appendElement(S,N["default"].createSVGElement("text",{text:n.xCoordinateFor(e),attributes:{"text-anchor":"middle",y:t-.5,x:e*(r.INTERSECTION_GAP_SIZE+1)-.5}}))});[-1*(16+16/2+16/(2*2)),16+16/2+16/(2*2)+(n.boardSize-1)*(r.INTERSECTION_GAP_SIZE+1)].forEach(function(t){N["default"].appendElement(S,N["default"].createSVGElement("text",{text:n.yCoordinateFor(e),attributes:{"text-anchor":"middle",y:e*(r.INTERSECTION_GAP_SIZE+1)-.5+16/(2*2),x:t-.5}}))});N["default"].appendElement(u,S)};for(var E=0;E<n.boardSize;E++){g(E)}}var _=N["default"].createSVGElement("g",{attributes:{class:"intersections"}});for(var w=0;w<n.boardSize;w++){for(var A=0;A<n.boardSize;A++){var P=N["default"].createSVGElement("g",{attributes:{class:"intersection"}});P.setAttribute("data-intersection-y",w);P.setAttribute("data-intersection-x",A);N["default"].appendElement(_,P);var I=N["default"].createSVGElement("g",{attributes:{class:"intersection-inner-container"}});N["default"].appendElement(P,I);var C=N["default"].createSVGElement("rect",{attributes:{y:w*(r.INTERSECTION_GAP_SIZE+1)-r.INTERSECTION_GAP_SIZE/2-.5,x:A*(r.INTERSECTION_GAP_SIZE+1)-r.INTERSECTION_GAP_SIZE/2-.5,width:r.INTERSECTION_GAP_SIZE,height:r.INTERSECTION_GAP_SIZE}});N["default"].appendElement(I,C);var x=r.INTERSECTION_GAP_SIZE/2;if(o){x-=1}var k={class:"stone",cy:w*(r.INTERSECTION_GAP_SIZE+1)-.5,cx:A*(r.INTERSECTION_GAP_SIZE+1)-.5,r:x};if(!a){N["default"].appendElement(I,N["default"].createSVGElement("circle",{attributes:{class:"stone-shadow",cy:k["cy"]+2,cx:k["cx"],r:x}}))}var O=N["default"].createSVGElement("circle",{attributes:k});N["default"].appendElement(I,O);N["default"].appendElement(I,N["default"].createSVGElement("circle",{attributes:{class:"marker",cy:w*(r.INTERSECTION_GAP_SIZE+1)-.5,cx:A*(r.INTERSECTION_GAP_SIZE+1)-.5,r:4.5}}));N["default"].appendElement(I,N["default"].createSVGElement("rect",{attributes:{class:"ko-marker",y:w*(r.INTERSECTION_GAP_SIZE+1)-6-.5,x:A*(r.INTERSECTION_GAP_SIZE+1)-6-.5,width:12,height:12}}));N["default"].appendElement(I,N["default"].createSVGElement("rect",{attributes:{class:"territory-marker",y:w*(r.INTERSECTION_GAP_SIZE+1)-6,x:A*(r.INTERSECTION_GAP_SIZE+1)-6,width:11,height:11}}));r.grid[w]=r.grid[w]||[];r.grid[w][A]=P;r.addIntersectionEventListeners(P,w,A)}}N["default"].appendElement(h,_);return u};i.prototype.generateBoard=function(t,e){var r=e.hasCoordinates,n=e.smallerStones,i=e.flatStones;this.blackGradientID=N["default"].randomID("black-gradient");this.whiteGradientID=N["default"].randomID("white-gradient");this.blueGradientID=N["default"].randomID("blue-gradient");var o=a(this,t,{hasCoordinates:r,smallerStones:n,flatStones:i});this.svgElement=o;this.svgElement.setAttribute("height",this.BOARD_LENGTH);this.svgElement.setAttribute("width",this.BOARD_LENGTH);return o};i.prototype.computeSizing=function(){var t=this;T["default"].prototype.computeSizing.call(this);this.svgElement.style.transform="none";window.requestAnimationFrame(function(){t.svgElement.style.transform=""})};i.prototype.setIntersectionClasses=function(t,e,r){if(t.getAttribute("class")!==r.join(" ")){t.setAttribute("class",r.join(" "))}if(!this.flatStones){if(e.isEmpty()){t.querySelector(".stone").setAttribute("style","")}else{var n=window.location.href.split("#")[0];t.querySelector(".stone").setAttribute("style","fill: url("+n+"#"+this[e.value+"GradientID"]+")")}}};var o=r["default"]=i},{"./renderer":10,"./utils":14}],14:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r["default"]=void 0;var n=r["default"]={flatten:function t(e){return e.reduce(function(t,e){return t.concat(e)})},flatMap:function t(e,r){return Array.prototype.concat.apply([],e.map(r))},cartesianProduct:function t(e,r){return this.flatten(e.map(function(e){return r.map(function(t){return[e,t]})}))},randomID:function t(e){var r=[0,1,2,3].map(function(){return Math.floor(Math.random()*65536).toString(16).substring(1)}).join("");return"".concat(e,"-").concat(r)},clone:function t(e){return e.cloneNode(true)},createElement:function t(e,r){var n=document.createElement(e);if(typeof r!=="undefined"){if(r["class"]){n.className=r["class"]}}return n},createSVGElement:function t(e,r){var n=this;var i="http://www.w3.org/2000/svg";var o=document.createElementNS(i,e);if(typeof r!=="undefined"){if(r["class"]){r["class"].split(" ").forEach(function(t){n.addClass(o,t)})}if(r.attributes){Object.keys(r.attributes).forEach(function(t){o.setAttribute(t,r.attributes[t])})}if(r.text){o.textContent=r.text.toString()}}return o},appendElement:function t(e,r){e.insertBefore(r,null)},addEventListener:function t(e,r,n){e.addEventListener(r,n,false)},removeClass:function t(e,r){if(!this.hasClass(e,r)){return}if(e.classList&&e.classList.remove){e.classList.remove(r);return}var n=RegExp("\\b"+r+"\\b","g");if(e instanceof SVGElement){e.setAttribute("class",e.getAttribute("class").replace(n,""))}else{e.className=e.getAttribute("class").replace(n,"")}},addClass:function t(e,r){if(e.classList&&e.classList.add){e.classList.add(r);return}if(e instanceof SVGElement){e.setAttribute("class",e.getAttribute("class")+" "+r)}else{e.className=e.getAttribute("class")+" "+r}},hasClass:function t(e,r){if(e.classList&&e.classList.contains){return e.classList.contains(r)}var n=RegExp("\\b"+r+"\\b","g");if(e instanceof SVGElement){return n.test(e.getAttribute("class"))}else{return n.test(e.className)}},toggleClass:function t(e,r){if(e.classList&&e.classList.toggle){e.classList.toggle(r);return}if(this.hasClass(e,r)){this.removeClass(e,r)}else{this.addClass(e,r)}},unique:function e(t){var e=[];t.forEach(function(t){if(e.indexOf(t)<0){e.push(t)}});return e}}},{}],15:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:true});r["default"]=void 0;var o={};function i(t,e,r,n){o[t]=o[t]||{};o[t][e]=o[t][e]||{};o[t][e][r]=o[t][e][r]||{};if(o[t][e][r][n]){return o[t][e][r][n]}var i=Math.floor(Math.random()*(Math.pow(2,31)-1));o[t][e][r][n]=i;return i}var n=r["default"]={hash:function t(r,e){var n=0;e.forEach(function(t){if(!t.isEmpty()){var e=i(r,t.y,t.x,t.value);n=n^e}});return n}}},{}]},{},[1])(1)});
